
  <!DOCTYPE html>
  <html>
    <head>
      <title>processConfiguration.ts</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../../../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../../../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../../../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="positive"><td class="">apps/api.movetcare.com/src/config/processConfiguration.ts</td><td class="">88.64%</td><td class="">75%</td><td class="">88</td><td class="">78</td><td class="">10</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">import { configureReasonGroups } from &quot;./../integrations/provet/entities/reason/configureReasonGroups&quot;;
import { configureUsers } from &quot;./configureUsers&quot;;
import { configureTelehealthStatus } from &quot;../integrations/provet/entities/appointment/configure/configureTelehealthStatus&quot;;
import { configureShifts } from &quot;../integrations/provet/entities/shift/configureShifts&quot;;
import { configureAppointments } from &quot;../integrations/provet/entities/appointment/configure/configureAppointments&quot;;
import { configureAppointmentEstimates } from &quot;../integrations/provet/entities/appointment/configure/configureAppointmentEstimates&quot;;
import { configureAppointmentOptionDetails } from &quot;../integrations/provet/entities/appointment/configure/configureAppointmentOptionDetails&quot;;
import { configureBreeds } from &quot;../integrations/provet/entities/patient/breeds/configureBreeds&quot;;
import { configureCancellationReasons } from &quot;../integrations/provet/entities/reason/configureCancellationReasons&quot;;
import { configureReasons } from &quot;../integrations/provet/entities/reason/configureReasons&quot;;
import { admin, DEBUG, throwError } from &quot;./config&quot;;
import { configureItems } from &quot;../integrations/provet/entities/item/configureItems&quot;;
import { sendNotification } from &quot;../notifications/sendNotification&quot;;

export const processConfiguration = async (options: {
  status: &quot;scheduled&quot; | &quot;error&quot; | &quot;complete&quot;;
  entities: Array&lt;
    | &quot;telehealth&quot;
    | &quot;breeds&quot;
    | &quot;reasons&quot;
    | &quot;appointments&quot;
    | &quot;cancellation_reasons&quot;
    | &quot;reason_groups&quot;
    | &quot;reminders&quot;
    | &quot;estimates&quot;
    | &quot;options&quot;
    | &quot;shifts&quot;
    | &quot;users&quot;
    | &quot;items&quot;
  &gt;;
}): Promise&lt;void&gt; =&gt; {
  const entity = options?.entities[0];
  if (DEBUG)
    console.log(`PROCESSING ${entity.toUpperCase()} APP CONFIGURATION TASK`);
  switch (entity) {
    case &quot;telehealth&quot;:
      configureTelehealthStatus();
      break;
    case &quot;breeds&quot;:
      configureBreeds();
      break;
    case &quot;reasons&quot;:
      configureReasons();
      break;
    case &quot;appointments&quot;:
      configureAppointments();
      break;
    case &quot;cancellation_reasons&quot;:
      configureCancellationReasons();
      break;
    case &quot;estimates&quot;:
      configureAppointmentEstimates();
      break;
    case &quot;options&quot;:
      configureAppointmentOptionDetails();
      break;
    case &quot;shifts&quot;:
      configureShifts();
      break;
    case &quot;users&quot;:
      configureUsers();
      break;
    case &quot;reason_groups&quot;:
      configureReasonGroups();
      break;
    case &quot;items&quot;:
      configureItems();
      break;
    default:
      break;
  }
  const entities = options?.entities.filter(
    (
      element:
        | &quot;telehealth&quot;
        | &quot;breeds&quot;
        | &quot;reasons&quot;
        | &quot;appointments&quot;
        | &quot;cancellation_reasons&quot;
        | &quot;reminders&quot;
        | &quot;estimates&quot;
        | &quot;options&quot;
        | &quot;shifts&quot;
        | &quot;reason_groups&quot;
        | &quot;users&quot;
        | &quot;items&quot;
    ) =&gt; element !== entity
  );
  if (entities.length &gt; 0)
    admin
      .firestore()
      .collection(&quot;tasks_queue&quot;)
      .doc(`configure_app_${entities[0]}`)
      .set(
        {
          options: {
            entities,
            status: &quot;queued&quot;,
          },
          worker: &quot;configure_app&quot;,
          status: &quot;scheduled&quot;,
          performAt: new Date(),
          createdOn: new Date(),
        },
        { merge: true }
      )
      .then(() =&gt; {
        console.log(
          &quot;APP CONFIGURATION TASK ADDED TO QUEUE =&gt; &quot;,
          `tasks_queue/configure_app_${entities[0]}`
        );
        console.log(
          `PLEASE WAIT ~${
            entities.length * 1.5
          } MINUTES FOR THE TASK QUEUE TO FINISH PROCESSING...`
        );
        sendNotification({
          type: &quot;slack&quot;,
          payload: {
            message: `:white_check_mark: FINISHED INITIALIZING CONFIGURATION FOR APP ENTITY: ${entity.toUpperCase()}`,
          },
        });
      })
      .catch((error: any) =&gt; throwError(error));
  else
    sendNotification({
      type: &quot;slack&quot;,
      payload: {
        message:
          &quot;:white_check_mark: FINISHED INITIALIZING CONFIGURATION FOR ALL APP ENTITIES!&quot;,
      },
    });
};
</textarea><pre id="annotations" style="display:none">[{&quot;file&quot;:&quot;apps/api.movetcare.com/src/config/processConfiguration.ts&quot;,&quot;line&quot;:10,&quot;character&quot;:9,&quot;text&quot;:&quot;admin&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;apps/api.movetcare.com/src/config/processConfiguration.ts&quot;,&quot;line&quot;:89,&quot;character&quot;:4,&quot;text&quot;:&quot;admin&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;apps/api.movetcare.com/src/config/processConfiguration.ts&quot;,&quot;line&quot;:90,&quot;character&quot;:7,&quot;text&quot;:&quot;firestore&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;apps/api.movetcare.com/src/config/processConfiguration.ts&quot;,&quot;line&quot;:91,&quot;character&quot;:7,&quot;text&quot;:&quot;collection&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;apps/api.movetcare.com/src/config/processConfiguration.ts&quot;,&quot;line&quot;:92,&quot;character&quot;:7,&quot;text&quot;:&quot;doc&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;apps/api.movetcare.com/src/config/processConfiguration.ts&quot;,&quot;line&quot;:93,&quot;character&quot;:7,&quot;text&quot;:&quot;set&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;apps/api.movetcare.com/src/config/processConfiguration.ts&quot;,&quot;line&quot;:106,&quot;character&quot;:7,&quot;text&quot;:&quot;then&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;apps/api.movetcare.com/src/config/processConfiguration.ts&quot;,&quot;line&quot;:123,&quot;character&quot;:7,&quot;text&quot;:&quot;catch&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;apps/api.movetcare.com/src/config/processConfiguration.ts&quot;,&quot;line&quot;:123,&quot;character&quot;:14,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;apps/api.movetcare.com/src/config/processConfiguration.ts&quot;,&quot;line&quot;:123,&quot;character&quot;:40,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1}]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Thu, 02 Mar 2023 15:37:59 GMT</p>
    </body>
  </html>
  